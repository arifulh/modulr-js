/**
* modulr-js v0.1.1 | 2014-11-25
* AMD Development
* by Helcon Mabesa
* MIT license http://opensource.org/licenses/MIT
**/
!function(a,b){a.Modulr=b}(window,function(a,b){function c(a,b){var c=null;return c=k(a)?a.apply(a,b):a}function d(a){var b="string"==typeof a?a.replace(/\s+/gi,""):"";return b.length>0&&"require"!==b&&"define"!==b&&"exports"!==b&&-1===b.indexOf("**")?!0:!1}function e(a){return"string"==typeof a&&a.indexOf("**")>-1?!0:!1}function f(){var a=window.location,b=a.pathname.split("/");return b.pop(),b=b.join("/")+"/",a.protocol+"//"+(a.host||a.hostname)+b}function g(a,b){return a=j(a),b=h(b),[a,b].join("/")}function h(a){return a=j(i(a))}function i(a){return"/"===a.charAt(0)?a.slice(1):a}function j(a){return"/"===a.charAt(a.length-1)?a.slice(0,a.length-1):a}function k(a){return"function"==typeof a?!0:!1}function l(a){return"object"!=typeof a||m(a)?!1:!0}function m(a){return a=a||!1,"[object Array]"===Object.prototype.toString.call(a)}function n(){var a=arguments;if("string"==typeof a[0]&&(a[0]=[p.prefix,a[0]].join(" ")),window.console&&window.console.log)try{return console.log.apply(console,a)}catch(b){console.log(a)}}function o(a){throw a=[p.prefix,a].join(" "),new Error(a)}var p={};p.prefix="[Modulr]";var q={},r=!1,s=!1;a(function(){r=!0});var t=function(h){function i(){h.baseUrl=h.baseUrl||f(),h.instanceDeps?w.loadInstanceDependencies(h.instanceDeps,function(){u=!0}):u=!0}h=h||{},h.context=h.context||"Modulr";var j=h.context;q[j]&&o("cannot instantiate multiple contexts: '"+j+"'"),q[j]={instance:this,stack:{}};var p=q[j].stack,r=!1,u=!1;this.version="0.1.1";var v=this;v.getConfig=function(){return h},v.define=function(a,b,c){d(a)||o("invalid id: '"+a+"'."),p[a]||(b=b||[],p[a]={executed:!1,exports:{},deps:b,factory:c})},v.require=function(c,d){r||(r=!0,i());var e=function(){var a=null,b=w.get(c);return b&&(a=b.exports||b.factory),a},f=function(){var a=e();return m(c)?void(k(d)&&d()):a};return u?f():void a(function(){b(function(){return u},function(){f()})})},v.config=function(a){if(a.context){var b=new t(a);return delete b.config,b}r?o("cannot re-configure Modulr"):h=a},v.ready=function(){s=!0};var w={get:function(a){var b=this,d=null;if(m(a))b.generateArrDeps(a);else if(p[a]){{var e=p[a];e.factory}if(!e.executed){e.executed=!0;var f=b.getDeps(a,e.deps);p[a].factory=c(e.factory,f)}d=p[a]}return d},getDeps:function(a,b){for(var c=this,d=[],e=0;e<b.length;e++){var f=b[e];m(f)?d.push(c.generateArrDeps(f,a)):"string"==typeof f?d=c.setDeps(d,f,a):(n("dependency:"),n(f),o("invalid dependency"))}return d},generateArrDeps:function(a,b){for(var c=this,d={},e=0;e<a.length;e++){var f=a[e];"string"==typeof f?d=c.setDeps(d,f,b):(n("dependency:"),n(f),o("invalid dependency"))}return d},getSelectors:function(a,b){var c=this,d=[],e=a.replace("**","");for(var f in p)0===f.indexOf(e)&&d.push(f);var g=c.generateArrDeps(d,b);return p[a]={executed:!0,exports:{},deps:[],factory:g},g},setDeps:function(a,b,c){var d=this;return m(a)?a.push("define"===b?v.define:"require"===b?v.require:"exports"===b?p[c].exports:p[b]?d.get(b).factory:e(b)?d.getSelectors(b,c):null):l(a)&&(a[b]="define"===b?v.define:"require"===b?v.require:"exports"===b?p[c].exports:p[b]?d.get(b).factory:null),a},loadInstanceDependencies:function(a,c){var d=this,e=[];for(var f in a)e.push(a[f]);var i=!0;b(function(){var a=e.length;if(i&&a>0){i=!0;var b=e.shift();d.loadInstanceScript(g(h.baseUrl,b)+".js",function(){i=!0})}return 0===a?!0:!1},function(){c()})},loadInstanceScript:function(a,b){var c=!1,d=document.createElement("script");d.setAttribute("data-modulr-context",j),d.type="text/javascript",d.async=!0,d.src=a,d.onload=d.onreadystatechange=function(){c||this.readyState&&"complete"!==this.readyState||(c=!0,b())},document.getElementsByTagName("head")[0].appendChild(d)}}};return new t}(function(){var a=function(){function a(a){for(m=1;a=c.shift();)a()}var b,c=[],d=!1,e=document,f=e.documentElement,g=f.doScroll,h="DOMContentLoaded",i="addEventListener",j="onreadystatechange",k="readyState",l=g?/^loaded|^c/:/^loaded|c/,m=l.test(e[k]);return e[i]&&e[i](h,b=function(){e.removeEventListener(h,b,d),a()},d),g&&e.attachEvent(j,b=function(){/^c/.test(e[k])&&(e.detachEvent(j,b),a())}),ready=g?function(a){self!=top?m?a():c.push(a):function(){try{f.doScroll("left")}catch(b){return setTimeout(function(){ready(a)},50)}a()}()}:function(a){m?a():c.push(a)}}();return a}(),function(){var a=function(){function a(a){return"number"==typeof a?!0:!1}function b(a){return"function"==typeof a?!0:!1}var c={attempts:999,timeout:50},d=arguments,e=!1;a(d[0])&&a(d[1])&&b(d[2])&&b(d[3])?e={attempts:d[0],timeout:d[1],check:d[2],success:d[3],expires:b(d[4])?d[4]:!1}:a(d[0])&&b(d[1])&&b(d[2])?e={attempts:d[0],timeout:c.timeout,check:d[1],success:d[2],expires:b(d[3])?d[3]:!1}:b(d[0])&&b(d[1])&&(e={attempts:c.attempts,timeout:c.timeout,check:d[0],success:d[1],expires:b(d[2])?d[2]:!1});var f,g=!1,h=function(){g?(clearTimeout(f),e.expires("aborted")):e.check()?(e.success(),clearTimeout(f)):e.attempts>0?f=setTimeout(function(){h()},e.timeout):e.expires("expired"),e.attempts--};return h(),{abort:function(){g=!0}}};return a}()));